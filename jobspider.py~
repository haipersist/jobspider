#!/usr/bin/python
# -*- coding:utf-8 -*-

import os
import re
import sys
from baseclass.base_spider import Base_Spider
from baseclass.database import Database


class Job_Spider(Base_Spider):

    def __init__(self,website):
        super(Job_Spider,self).__init__(website)
        self.db=Database('log')
        self.table='job_info'
        self.host_url=self.set_cfg('host_url','host')


    #parse url's detail
    def parse(self,url):
        pass

    # url generator
    def pages_parse(self,keyword):
        pass

    def store(self,data):
		print data
        cols=['date','jobintro','title','link','company']
        for item in data:
            if item:
                [item.pop(key) for key in item.keys() if key not in cols]
                try:
                   self.db.insert_by_dic(self.table,item)
                except Exception,e:
                    print str(e)
                    continue

    
    def _create_table(self,tablename):
        self.db.sql_exec('drop table if exists %s'%tablename)
        cols="title varchar(255) not null default '',link varchar(255) not null default '',date date ,jobintro varchar(1024) not null default '' "
        self.db.create_table(tablename,cols)



if __name__=="__main__":

    Job_Spider('byr')
    pass

